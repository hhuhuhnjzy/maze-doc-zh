.. _overview:

项目概述
========

Maze 是一个专为**大语言模型代理**（LLM Agent）应用设计的**分布式执行框架**，致力于解决当前 LLM Agent 在高并发、复杂任务场景下的性能瓶颈与资源利用率低的问题。随着大模型能力的不断增强，智能代理正从单机实验走向生产级部署，对系统可扩展性、执行效率和运维能力提出了更高要求。Maze 通过创新的架构设计，实现了对复杂 Agent 工作流的高效调度与分布式执行。

核心挑战
--------

传统的 LLM Agent 框架（如 LangChain、AutoGPT 等）通常采用“**代理级部署**”（Agent-Level Deployment）模式，即将整个 Agent 实例作为一个整体单元部署在单个计算节点上。这种模式存在以下严重问题：

- **资源瓶颈**：一个 Agent 可能同时包含 CPU 密集型、GPU 密集型和 I/O 密集型任务，导致节点资源争抢，整体吞吐量受限。
- **负载不均**：部分节点可能因运行复杂 Agent 而过载，而其他节点则处于空闲状态，造成资源浪费。
- **扩展性差**：难以通过简单增加节点来线性提升系统处理能力。

Maze 的解决方案
----------------

为应对上述挑战，Maze 提出了革命性的“**任务级部署**”（Task-Level Deployment）架构。其核心思想是将复杂的 Agent 工作流分解为一系列**细粒度的任务**（Task），并基于依赖关系构建有向无环图（DAG）。这些任务由中央调度器动态分发到集群中的不同计算节点上并行执行。

这一设计带来了三大核心优势：

1. **高效的负载均衡**  
   Maze 能够感知每个任务的资源需求（如 CPU、GPU、内存）和每个节点的实时负载，实现精细化的任务调度。例如，将模型推理任务调度到 GPU 节点，将数据处理任务分配到 CPU 节点，从而最大化集群资源利用率。

2. **强大的可扩展性**  
   系统采用去中心化的执行模型，通过高效的任务分发机制，支持随着计算节点的增加实现近线性的性能提升。业务增长时，只需横向扩展 Worker 节点即可。

3. **卓越的易用性**  
   用户无需成为分布式系统专家。通过简洁的 Python API 和 `@tool` 装饰器，开发者可以像编写单机程序一样定义任务和编排工作流，Maze 自动处理任务序列化、代码分发、依赖解析和远程执行。

系统架构
--------

Maze 采用模块化设计，由四大核心组件协同工作，共同构成一个完整的分布式 Agent 管理平台：

.. list-table::
   :widths: 20 80
   :header-rows: 1

   * - **组件**
     - **功能描述**

   * - **MaRegister (注册模块)**
     - 负责定义 Agent 的工作流。用户通过 Python API 将任务函数注册到计算图中，并指定任务间的依赖关系（DAG）。

   * - **MaLearn (学习模块)**
     - 一个在线学习模型，基于历史执行数据预测任务的复杂度（如执行时间），为调度器提供智能决策依据。实验表明，Maze 采用 XGBoost 结合增量学习的方式，在预测准确性和训练效率之间取得了最佳平衡。

   * - **MaPath (路径/调度模块)**
     - 框架的智能调度核心，实现了 **DAPS**（DAG-Aware Predictive Scheduling）算法。MaPath 综合考虑任务优先级、依赖关系、资源需求和数据亲和性，动态决定任务的执行位置。

   * - **MaWorker (工作模块)**
     - 部署在每个计算节点上的执行引擎，负责接收调度指令、执行任务、管理运行环境并回报状态。

运行模式
--------

Maze 支持两种运行模式，灵活适配开发与生产场景：

- **本地模式 (Local Mode)**  
  无需启动中心服务或 Ray 集群，工作流在本地以独立线程执行，适用于快速开发和调试。

- **服务器模式 (Server Mode)**  
  基于 Ray 构建的分布式执行环境，支持多节点协同工作，适用于生产环境的高并发、大规模任务处理。

应用场景
--------

Maze 特别适用于以下场景：

- 多步骤、长周期的 LLM Agent 工作流（如自动化报告生成、智能客服流程）
- 异构任务混合执行（如文本生成 + 图像识别 + 数据库查询）
- 需要高可用、高并发的企业级 AI 应用

通过 Maze，开发者可以轻松构建高性能、可扩展的分布式智能代理系统，释放大模型在真实生产环境中的全部潜力。